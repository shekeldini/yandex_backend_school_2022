# Домашнее задание к лекции про архитектуру распределенных систем

В корне проекта лежит файл docker-compose.yml, в котором определено 2 одинаковых сервиса tokenizer.

Tokenizer - это простой сервис для получения токенов.
Он умеет обрабатывать единственный запрос
`GET 0.0.0.0:8000/token?id=<your_string_id>&timestamp=<timestamp_in_seconds>`
- id - некоторый идентификатор пользователя
- timestamp - время в epoch seconds

В ответ приходит сгенерированный по этим данным токен.

К сожалению, этот сервис обладает не самой высокой стабильностью. Иногда он ломается и не может дать корректный ответ. Иногда запросов слишком много, и он может долго отвечать, либо сообщает о невозможности выполнить запрос из-за загруженности.

На лекции вы, среди прочих тем, обсуждали балансировку, которая помогает нам справляться с нестабильностью компонент системы, ретрая запросы и направляя их на здоровые инстансы сервиса.
В данном задании требуется добавить в docker-compose.yml дополнительный сервис-балансировщик, который будет работать поверх двух инстансов сервиса и обеспечивать наиболее возможную отказоустойчивость за счет обработки ответов от инстансов сервиса.

Балансировщиком может выступать как и готовое решение (например, nginx) с вашей конфигурацией, так и ваш собственный сервис, написанный на java/python (в зависимости от трека ШБР).

Образ сервиса `harand/tokenizer` лежит тут - https://hub.docker.com/repository/docker/harand/tokenizer. Но должен автоматически спулиться при запуске `docker-compose up`.

## Поднятие балансера

`make up`

## Запуск тестов с покрытием

`poetry install`

`make test`