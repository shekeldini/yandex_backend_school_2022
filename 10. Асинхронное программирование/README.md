## Домашнее задание к лекции по асинхронному программированию

Необходимо написать сервис balance, который управляет балансом пользователей.
Сервис умеет изменять баланс пользователя и отдавать текущее его значение.

### Операции

#### Изменение баланса
`POST /changeBalance` со следующим телом запроса
```aidl
{
  userId: String,
  context: String,
  balanceChange: BigInt/Long,
  timestamp: Timestamp
}
```
1. Сходить в сервис Approver в ручку `GET /approve?userId=<id>&balanceChange=<change>` для запросов с abs(balanceChange) > 100000. Сервис отдаст 200, если операция возможна, иначе 403. Баланс можно менять только в случае успешного аппрува
2. Проверить, что баланс пользователя не станет отрицательным после операции
3. Обновить баланс пользователя в таблице balance
4. Сохранить операцию в базу в таблицу changes_history
5. Залогировать операцию в специальный текстовый файл operations.log, который в дальнейшем секретно будет доставляться в хранилище для просмотров по запросам служб безопасности.
6. Вернуть 200 OK, либо 403, в зависимости от вердикта Approver-а и баланса пользователя

При этом
* Approver для утверждения запускает сложную логику, учитывающую данные пользователя, поэтому отвечает за несколько сотен миллисекунд
* Операция должна учитывать все операции с timestamp-ом меньше либо равным timestamp-у самой операции

#### Получение баланса пользователя
`GET /<userId>/balance?timestamp=<timestamp>` 
1. Сходить в базу за текущим балансом пользователя, учитывая все операции с timestamp меньше либо равным timestamp-у операции
2. Записать информацию о запросе баланса в файл operations.log

Предполагаем, что в эту ручку может быть много трафика.

### Окружение
В корне проекта лежит файл env/docker_compose.yml. В нем описан сервер PostresQL и сервис approver.

### Оценка и проверка
Проверка будет производиться менторами в ручном формате. Будет оцениваться применение средств конкурентности для масштабирования и средств синхронизации (каких-либо) для поддержэния согласованного состояния данных.
